{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { useCallback, useState, useMemo } from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { parse, stringify } from 'query-string';\nimport lodashDebounce from 'lodash/debounce';\nimport pickBy from 'lodash/pickBy';\nimport queryReducer, { SET_FILTER, SET_PAGE, SET_PER_PAGE, SET_SORT, SORT_ASC } from '../reducer/admin/resource/list/queryReducer';\nimport { changeListParams } from '../actions/listActions';\nimport removeEmpty from '../util/removeEmpty';\nimport removeKey from '../util/removeKey';\nimport { useHistory } from 'react-router-dom';\nvar emptyObject = {};\nvar defaultSort = {\n  field: 'id',\n  order: SORT_ASC\n};\nvar defaultParams = {};\n/**\n * Get the list parameters (page, sort, filters) and modifiers.\n *\n * These parameters are merged from 3 sources:\n *   - the query string from the URL\n *   - the params stored in the state (from previous navigation)\n *   - the options passed to the hook (including the filter defaultValues)\n *\n * @returns {Array} A tuple [parameters, modifiers].\n * Destructure as [\n *    { page, perPage, sort, order, filter, filterValues, displayedFilters, requestSignature },\n *    { setFilters, hideFilter, showFilter, setPage, setPerPage, setSort }\n * ]\n *\n * @example\n *\n * const [listParams, listParamsActions] = useListParams({\n *      resource: 'posts',\n *      location: location // From react-router. Injected to your component by react-admin inside a List\n *      filterDefaultValues: {\n *          published: true\n *      },\n *      sort: {\n *          field: 'published_at',\n *          order: 'DESC'\n *      },\n *      perPage: 25\n * });\n *\n * const {\n *      page,\n *      perPage,\n *      sort,\n *      order,\n *      filter,\n *      filterValues,\n *      displayedFilters,\n *      requestSignature\n * } = listParams;\n *\n * const {\n *      setFilters,\n *      hideFilter,\n *      showFilter,\n *      setPage,\n *      setPerPage,\n *      setSort,\n * } = listParamsActions;\n */\n\nvar useListParams = function (_a) {\n  var resource = _a.resource,\n      location = _a.location,\n      filterDefaultValues = _a.filterDefaultValues,\n      _b = _a.sort,\n      sort = _b === void 0 ? defaultSort : _b,\n      _c = _a.perPage,\n      perPage = _c === void 0 ? 10 : _c,\n      _d = _a.debounce,\n      debounce = _d === void 0 ? 500 : _d;\n\n  var _e = useState({}),\n      displayedFilters = _e[0],\n      setDisplayedFilters = _e[1];\n\n  var dispatch = useDispatch();\n  var history = useHistory();\n  var params = useSelector(function (reduxState) {\n    return reduxState.admin.resources[resource] ? reduxState.admin.resources[resource].list : defaultParams;\n  }, shallowEqual).params;\n  var requestSignature = [location.search, resource, params, filterDefaultValues, JSON.stringify(sort), perPage];\n  var query = useMemo(function () {\n    return getQuery({\n      location: location,\n      params: params,\n      filterDefaultValues: filterDefaultValues,\n      sort: sort,\n      perPage: perPage\n    });\n  }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  var changeParams = useCallback(function (action) {\n    var newParams = queryReducer(query, action);\n    history.push({\n      search: \"?\" + stringify(__assign({}, newParams, {\n        filter: JSON.stringify(newParams.filter)\n      }))\n    });\n    dispatch(changeListParams(resource, newParams));\n  }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var setSort = useCallback(function (newSort) {\n    return changeParams({\n      type: SET_SORT,\n      payload: {\n        sort: newSort\n      }\n    });\n  }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  var setPage = useCallback(function (newPage) {\n    return changeParams({\n      type: SET_PAGE,\n      payload: newPage\n    });\n  }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  var setPerPage = useCallback(function (newPerPage) {\n    return changeParams({\n      type: SET_PER_PAGE,\n      payload: newPerPage\n    });\n  }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  var filterValues = query.filter || emptyObject;\n  var debouncedSetFilters = lodashDebounce(function (newFilters) {\n    return changeParams({\n      type: SET_FILTER,\n      payload: removeEmpty(newFilters)\n    });\n  }, debounce);\n  var setFilters = useCallback(function (filters) {\n    return debouncedSetFilters(filters);\n  }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n  );\n  var hideFilter = useCallback(function (filterName) {\n    setDisplayedFilters(function (previousFilters) {\n      var _a;\n\n      return __assign({}, previousFilters, (_a = {}, _a[filterName] = false, _a));\n    });\n    var newFilters = removeKey(filterValues, filterName);\n    setFilters(newFilters);\n  }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var showFilter = useCallback(function (filterName, defaultValue) {\n    var _a;\n\n    setDisplayedFilters(function (previousFilters) {\n      var _a;\n\n      return __assign({}, previousFilters, (_a = {}, _a[filterName] = true, _a));\n    });\n\n    if (typeof defaultValue !== 'undefined') {\n      setFilters(__assign({}, filterValues, (_a = {}, _a[filterName] = defaultValue, _a)));\n    }\n  }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return [__assign({\n    displayedFilters: displayedFilters,\n    filterValues: filterValues,\n    requestSignature: requestSignature\n  }, query), {\n    changeParams: changeParams,\n    setPage: setPage,\n    setPerPage: setPerPage,\n    setSort: setSort,\n    setFilters: setFilters,\n    hideFilter: hideFilter,\n    showFilter: showFilter\n  }];\n};\n\nexport var validQueryParams = ['page', 'perPage', 'sort', 'order', 'filter'];\nexport var parseQueryFromLocation = function (_a) {\n  var search = _a.search;\n  var query = pickBy(parse(search), function (v, k) {\n    return validQueryParams.indexOf(k) !== -1;\n  });\n\n  if (query.filter && typeof query.filter === 'string') {\n    try {\n      query.filter = JSON.parse(query.filter);\n    } catch (err) {\n      delete query.filter;\n    }\n  }\n\n  return query;\n};\n/**\n * Check if user has already set custom sort, page, or filters for this list\n *\n * User params come from the Redux store as the params props. By default,\n * this object is:\n *\n * { filter: {}, order: null, page: 1, perPage: null, sort: null }\n *\n * To check if the user has custom params, we must compare the params\n * to these initial values.\n *\n * @param {object} params\n */\n\nexport var hasCustomParams = function (params) {\n  return params && params.filter && (Object.keys(params.filter).length > 0 || params.order != null || params.page !== 1 || params.perPage != null || params.sort != null);\n};\n/**\n * Merge list params from 3 different sources:\n *   - the query string\n *   - the params stored in the state (from previous navigation)\n *   - the props passed to the List component (including the filter defaultValues)\n */\n\nexport var getQuery = function (_a) {\n  var location = _a.location,\n      params = _a.params,\n      filterDefaultValues = _a.filterDefaultValues,\n      sort = _a.sort,\n      perPage = _a.perPage;\n  var queryFromLocation = parseQueryFromLocation(location);\n  var query = Object.keys(queryFromLocation).length > 0 ? queryFromLocation : hasCustomParams(params) ? __assign({}, params) : {\n    filter: filterDefaultValues || {}\n  };\n\n  if (!query.sort) {\n    query.sort = sort.field;\n    query.order = sort.order;\n  }\n\n  if (!query.perPage) {\n    query.perPage = perPage;\n  }\n\n  if (!query.page) {\n    query.page = 1;\n  }\n\n  return __assign({}, query, {\n    page: getNumberOrDefault(query.page, 1),\n    perPage: getNumberOrDefault(query.perPage, 10)\n  });\n};\nexport var getNumberOrDefault = function (possibleNumber, defaultValue) {\n  return (typeof possibleNumber === 'string' ? parseInt(possibleNumber, 10) : possibleNumber) || defaultValue;\n};\nexport default useListParams;","map":{"version":3,"sources":["/home/ubuntu/truck-rewards/node_modules/ra-core/esm/controller/useListParams.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useCallback","useState","useMemo","useSelector","useDispatch","shallowEqual","parse","stringify","lodashDebounce","pickBy","queryReducer","SET_FILTER","SET_PAGE","SET_PER_PAGE","SET_SORT","SORT_ASC","changeListParams","removeEmpty","removeKey","useHistory","emptyObject","defaultSort","field","order","defaultParams","useListParams","_a","resource","location","filterDefaultValues","_b","sort","_c","perPage","_d","debounce","_e","displayedFilters","setDisplayedFilters","dispatch","history","params","reduxState","admin","resources","list","requestSignature","search","JSON","query","getQuery","changeParams","action","newParams","push","filter","setSort","newSort","type","payload","setPage","newPage","setPerPage","newPerPage","filterValues","debouncedSetFilters","newFilters","setFilters","filters","hideFilter","filterName","previousFilters","showFilter","defaultValue","validQueryParams","parseQueryFromLocation","v","k","indexOf","err","hasCustomParams","keys","page","queryFromLocation","getNumberOrDefault","possibleNumber","parseInt"],"mappings":"AAAA,IAAIA,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACP;;AACD,WAAON,CAAP;AACH,GAPD;;AAQA,SAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,CAVD;;AAWA,SAASO,WAAT,EAAsBC,QAAtB,EAAgCC,OAAhC,QAA+C,OAA/C;AACA,SAASC,WAAT,EAAsBC,WAAtB,EAAmCC,YAAnC,QAAuD,aAAvD;AACA,SAASC,KAAT,EAAgBC,SAAhB,QAAiC,cAAjC;AACA,OAAOC,cAAP,MAA2B,iBAA3B;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,YAAP,IAAuBC,UAAvB,EAAmCC,QAAnC,EAA6CC,YAA7C,EAA2DC,QAA3D,EAAqEC,QAArE,QAAsF,6CAAtF;AACA,SAASC,gBAAT,QAAiC,wBAAjC;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,OAAOC,SAAP,MAAsB,mBAAtB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,IAAIC,WAAW,GAAG,EAAlB;AACA,IAAIC,WAAW,GAAG;AACdC,EAAAA,KAAK,EAAE,IADO;AAEdC,EAAAA,KAAK,EAAER;AAFO,CAAlB;AAIA,IAAIS,aAAa,GAAG,EAApB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA,IAAIC,aAAa,GAAG,UAAUC,EAAV,EAAc;AAC9B,MAAIC,QAAQ,GAAGD,EAAE,CAACC,QAAlB;AAAA,MAA4BC,QAAQ,GAAGF,EAAE,CAACE,QAA1C;AAAA,MAAoDC,mBAAmB,GAAGH,EAAE,CAACG,mBAA7E;AAAA,MAAkGC,EAAE,GAAGJ,EAAE,CAACK,IAA1G;AAAA,MAAgHA,IAAI,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgBT,WAAhB,GAA8BS,EAArJ;AAAA,MAAyJE,EAAE,GAAGN,EAAE,CAACO,OAAjK;AAAA,MAA0KA,OAAO,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAAzM;AAAA,MAA6ME,EAAE,GAAGR,EAAE,CAACS,QAArN;AAAA,MAA+NA,QAAQ,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,GAAhB,GAAsBA,EAAhQ;;AACA,MAAIE,EAAE,GAAGnC,QAAQ,CAAC,EAAD,CAAjB;AAAA,MAAuBoC,gBAAgB,GAAGD,EAAE,CAAC,CAAD,CAA5C;AAAA,MAAiDE,mBAAmB,GAAGF,EAAE,CAAC,CAAD,CAAzE;;AACA,MAAIG,QAAQ,GAAGnC,WAAW,EAA1B;AACA,MAAIoC,OAAO,GAAGrB,UAAU,EAAxB;AACA,MAAIsB,MAAM,GAAGtC,WAAW,CAAC,UAAUuC,UAAV,EAAsB;AAC3C,WAAOA,UAAU,CAACC,KAAX,CAAiBC,SAAjB,CAA2BjB,QAA3B,IACDe,UAAU,CAACC,KAAX,CAAiBC,SAAjB,CAA2BjB,QAA3B,EAAqCkB,IADpC,GAEDrB,aAFN;AAGH,GAJuB,EAIrBnB,YAJqB,CAAX,CAIIoC,MAJjB;AAKA,MAAIK,gBAAgB,GAAG,CACnBlB,QAAQ,CAACmB,MADU,EAEnBpB,QAFmB,EAGnBc,MAHmB,EAInBZ,mBAJmB,EAKnBmB,IAAI,CAACzC,SAAL,CAAewB,IAAf,CALmB,EAMnBE,OANmB,CAAvB;AAQA,MAAIgB,KAAK,GAAG/C,OAAO,CAAC,YAAY;AAC5B,WAAOgD,QAAQ,CAAC;AACZtB,MAAAA,QAAQ,EAAEA,QADE;AAEZa,MAAAA,MAAM,EAAEA,MAFI;AAGZZ,MAAAA,mBAAmB,EAAEA,mBAHT;AAIZE,MAAAA,IAAI,EAAEA,IAJM;AAKZE,MAAAA,OAAO,EAAEA;AALG,KAAD,CAAf;AAOH,GARkB,EAQhBa,gBARgB,CAQC;AARD,GAAnB;AAUA,MAAIK,YAAY,GAAGnD,WAAW,CAAC,UAAUoD,MAAV,EAAkB;AAC7C,QAAIC,SAAS,GAAG3C,YAAY,CAACuC,KAAD,EAAQG,MAAR,CAA5B;AACAZ,IAAAA,OAAO,CAACc,IAAR,CAAa;AACTP,MAAAA,MAAM,EAAE,MAAMxC,SAAS,CAACrB,QAAQ,CAAC,EAAD,EAAKmE,SAAL,EAAgB;AAAEE,QAAAA,MAAM,EAAEP,IAAI,CAACzC,SAAL,CAAe8C,SAAS,CAACE,MAAzB;AAAV,OAAhB,CAAT;AADd,KAAb;AAGAhB,IAAAA,QAAQ,CAACvB,gBAAgB,CAACW,QAAD,EAAW0B,SAAX,CAAjB,CAAR;AACH,GAN6B,EAM3BP,gBAN2B,CAA9B,CA5B8B,CAkCR;;AACtB,MAAIU,OAAO,GAAGxD,WAAW,CAAC,UAAUyD,OAAV,EAAmB;AACzC,WAAON,YAAY,CAAC;AAAEO,MAAAA,IAAI,EAAE5C,QAAR;AAAkB6C,MAAAA,OAAO,EAAE;AAAE5B,QAAAA,IAAI,EAAE0B;AAAR;AAA3B,KAAD,CAAnB;AACH,GAFwB,EAEtBX,gBAFsB,CAEL;AAFK,GAAzB;AAIA,MAAIc,OAAO,GAAG5D,WAAW,CAAC,UAAU6D,OAAV,EAAmB;AAAE,WAAOV,YAAY,CAAC;AAAEO,MAAAA,IAAI,EAAE9C,QAAR;AAAkB+C,MAAAA,OAAO,EAAEE;AAA3B,KAAD,CAAnB;AAA4D,GAAlF,EAAoFf,gBAApF,CAAqG;AAArG,GAAzB;AAEA,MAAIgB,UAAU,GAAG9D,WAAW,CAAC,UAAU+D,UAAV,EAAsB;AAC/C,WAAOZ,YAAY,CAAC;AAAEO,MAAAA,IAAI,EAAE7C,YAAR;AAAsB8C,MAAAA,OAAO,EAAEI;AAA/B,KAAD,CAAnB;AACH,GAF2B,EAEzBjB,gBAFyB,CAER;AAFQ,GAA5B;AAIA,MAAIkB,YAAY,GAAGf,KAAK,CAACM,MAAN,IAAgBnC,WAAnC;AACA,MAAI6C,mBAAmB,GAAGzD,cAAc,CAAC,UAAU0D,UAAV,EAAsB;AAC3D,WAAOf,YAAY,CAAC;AAChBO,MAAAA,IAAI,EAAE/C,UADU;AAEhBgD,MAAAA,OAAO,EAAE1C,WAAW,CAACiD,UAAD;AAFJ,KAAD,CAAnB;AAIH,GALuC,EAKrC/B,QALqC,CAAxC;AAMA,MAAIgC,UAAU,GAAGnE,WAAW,CAAC,UAAUoE,OAAV,EAAmB;AAAE,WAAOH,mBAAmB,CAACG,OAAD,CAA1B;AAAsC,GAA5D,EAA8DtB,gBAA9D,CAA+E;AAA/E,GAA5B;AAEA,MAAIuB,UAAU,GAAGrE,WAAW,CAAC,UAAUsE,UAAV,EAAsB;AAC/ChC,IAAAA,mBAAmB,CAAC,UAAUiC,eAAV,EAA2B;AAC3C,UAAI7C,EAAJ;;AACA,aAAQxC,QAAQ,CAAC,EAAD,EAAKqF,eAAL,GAAuB7C,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC4C,UAAD,CAAF,GAAiB,KAA1B,EAAiC5C,EAAxD,EAAhB;AACH,KAHkB,CAAnB;AAIA,QAAIwC,UAAU,GAAGhD,SAAS,CAAC8C,YAAD,EAAeM,UAAf,CAA1B;AACAH,IAAAA,UAAU,CAACD,UAAD,CAAV;AACH,GAP2B,EAOzBpB,gBAPyB,CAA5B,CAtD8B,CA6DR;;AACtB,MAAI0B,UAAU,GAAGxE,WAAW,CAAC,UAAUsE,UAAV,EAAsBG,YAAtB,EAAoC;AAC7D,QAAI/C,EAAJ;;AACAY,IAAAA,mBAAmB,CAAC,UAAUiC,eAAV,EAA2B;AAC3C,UAAI7C,EAAJ;;AACA,aAAQxC,QAAQ,CAAC,EAAD,EAAKqF,eAAL,GAAuB7C,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC4C,UAAD,CAAF,GAAiB,IAA1B,EAAgC5C,EAAvD,EAAhB;AACH,KAHkB,CAAnB;;AAIA,QAAI,OAAO+C,YAAP,KAAwB,WAA5B,EAAyC;AACrCN,MAAAA,UAAU,CAACjF,QAAQ,CAAC,EAAD,EAAK8E,YAAL,GAAoBtC,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC4C,UAAD,CAAF,GAAiBG,YAA1B,EAAwC/C,EAA5D,EAAT,CAAV;AACH;AACJ,GAT2B,EASzBoB,gBATyB,CAA5B,CA9D8B,CAuER;;AACtB,SAAO,CACH5D,QAAQ,CAAC;AAAEmD,IAAAA,gBAAgB,EAAEA,gBAApB;AACL2B,IAAAA,YAAY,EAAEA,YADT;AAELlB,IAAAA,gBAAgB,EAAEA;AAFb,GAAD,EAEkCG,KAFlC,CADL,EAIH;AACIE,IAAAA,YAAY,EAAEA,YADlB;AAEIS,IAAAA,OAAO,EAAEA,OAFb;AAGIE,IAAAA,UAAU,EAAEA,UAHhB;AAIIN,IAAAA,OAAO,EAAEA,OAJb;AAKIW,IAAAA,UAAU,EAAEA,UALhB;AAMIE,IAAAA,UAAU,EAAEA,UANhB;AAOIG,IAAAA,UAAU,EAAEA;AAPhB,GAJG,CAAP;AAcH,CAtFD;;AAuFA,OAAO,IAAIE,gBAAgB,GAAG,CAAC,MAAD,EAAS,SAAT,EAAoB,MAApB,EAA4B,OAA5B,EAAqC,QAArC,CAAvB;AACP,OAAO,IAAIC,sBAAsB,GAAG,UAAUjD,EAAV,EAAc;AAC9C,MAAIqB,MAAM,GAAGrB,EAAE,CAACqB,MAAhB;AACA,MAAIE,KAAK,GAAGxC,MAAM,CAACH,KAAK,CAACyC,MAAD,CAAN,EAAgB,UAAU6B,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAOH,gBAAgB,CAACI,OAAjB,CAAyBD,CAAzB,MAAgC,CAAC,CAAxC;AAA4C,GAA9E,CAAlB;;AACA,MAAI5B,KAAK,CAACM,MAAN,IAAgB,OAAON,KAAK,CAACM,MAAb,KAAwB,QAA5C,EAAsD;AAClD,QAAI;AACAN,MAAAA,KAAK,CAACM,MAAN,GAAeP,IAAI,CAAC1C,KAAL,CAAW2C,KAAK,CAACM,MAAjB,CAAf;AACH,KAFD,CAGA,OAAOwB,GAAP,EAAY;AACR,aAAO9B,KAAK,CAACM,MAAb;AACH;AACJ;;AACD,SAAON,KAAP;AACH,CAZM;AAaP;;;;;;;;;;;;;;AAaA,OAAO,IAAI+B,eAAe,GAAG,UAAUvC,MAAV,EAAkB;AAC3C,SAAQA,MAAM,IACVA,MAAM,CAACc,MADH,KAEHpE,MAAM,CAAC8F,IAAP,CAAYxC,MAAM,CAACc,MAAnB,EAA2B7D,MAA3B,GAAoC,CAApC,IACG+C,MAAM,CAAClB,KAAP,IAAgB,IADnB,IAEGkB,MAAM,CAACyC,IAAP,KAAgB,CAFnB,IAGGzC,MAAM,CAACR,OAAP,IAAkB,IAHrB,IAIGQ,MAAM,CAACV,IAAP,IAAe,IANf,CAAR;AAOH,CARM;AASP;;;;;;;AAMA,OAAO,IAAImB,QAAQ,GAAG,UAAUxB,EAAV,EAAc;AAChC,MAAIE,QAAQ,GAAGF,EAAE,CAACE,QAAlB;AAAA,MAA4Ba,MAAM,GAAGf,EAAE,CAACe,MAAxC;AAAA,MAAgDZ,mBAAmB,GAAGH,EAAE,CAACG,mBAAzE;AAAA,MAA8FE,IAAI,GAAGL,EAAE,CAACK,IAAxG;AAAA,MAA8GE,OAAO,GAAGP,EAAE,CAACO,OAA3H;AACA,MAAIkD,iBAAiB,GAAGR,sBAAsB,CAAC/C,QAAD,CAA9C;AACA,MAAIqB,KAAK,GAAG9D,MAAM,CAAC8F,IAAP,CAAYE,iBAAZ,EAA+BzF,MAA/B,GAAwC,CAAxC,GACNyF,iBADM,GAENH,eAAe,CAACvC,MAAD,CAAf,GACIvD,QAAQ,CAAC,EAAD,EAAKuD,MAAL,CADZ,GAC2B;AAAEc,IAAAA,MAAM,EAAE1B,mBAAmB,IAAI;AAAjC,GAHjC;;AAIA,MAAI,CAACoB,KAAK,CAAClB,IAAX,EAAiB;AACbkB,IAAAA,KAAK,CAAClB,IAAN,GAAaA,IAAI,CAACT,KAAlB;AACA2B,IAAAA,KAAK,CAAC1B,KAAN,GAAcQ,IAAI,CAACR,KAAnB;AACH;;AACD,MAAI,CAAC0B,KAAK,CAAChB,OAAX,EAAoB;AAChBgB,IAAAA,KAAK,CAAChB,OAAN,GAAgBA,OAAhB;AACH;;AACD,MAAI,CAACgB,KAAK,CAACiC,IAAX,EAAiB;AACbjC,IAAAA,KAAK,CAACiC,IAAN,GAAa,CAAb;AACH;;AACD,SAAOhG,QAAQ,CAAC,EAAD,EAAK+D,KAAL,EAAY;AAAEiC,IAAAA,IAAI,EAAEE,kBAAkB,CAACnC,KAAK,CAACiC,IAAP,EAAa,CAAb,CAA1B;AAA2CjD,IAAAA,OAAO,EAAEmD,kBAAkB,CAACnC,KAAK,CAAChB,OAAP,EAAgB,EAAhB;AAAtE,GAAZ,CAAf;AACH,CAlBM;AAmBP,OAAO,IAAImD,kBAAkB,GAAG,UAAUC,cAAV,EAA0BZ,YAA1B,EAAwC;AACpE,SAAO,CAAC,OAAOY,cAAP,KAA0B,QAA1B,GACFC,QAAQ,CAACD,cAAD,EAAiB,EAAjB,CADN,GAEFA,cAFC,KAEkBZ,YAFzB;AAGH,CAJM;AAKP,eAAehD,aAAf","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useCallback, useState, useMemo } from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { parse, stringify } from 'query-string';\nimport lodashDebounce from 'lodash/debounce';\nimport pickBy from 'lodash/pickBy';\nimport queryReducer, { SET_FILTER, SET_PAGE, SET_PER_PAGE, SET_SORT, SORT_ASC, } from '../reducer/admin/resource/list/queryReducer';\nimport { changeListParams } from '../actions/listActions';\nimport removeEmpty from '../util/removeEmpty';\nimport removeKey from '../util/removeKey';\nimport { useHistory } from 'react-router-dom';\nvar emptyObject = {};\nvar defaultSort = {\n    field: 'id',\n    order: SORT_ASC,\n};\nvar defaultParams = {};\n/**\n * Get the list parameters (page, sort, filters) and modifiers.\n *\n * These parameters are merged from 3 sources:\n *   - the query string from the URL\n *   - the params stored in the state (from previous navigation)\n *   - the options passed to the hook (including the filter defaultValues)\n *\n * @returns {Array} A tuple [parameters, modifiers].\n * Destructure as [\n *    { page, perPage, sort, order, filter, filterValues, displayedFilters, requestSignature },\n *    { setFilters, hideFilter, showFilter, setPage, setPerPage, setSort }\n * ]\n *\n * @example\n *\n * const [listParams, listParamsActions] = useListParams({\n *      resource: 'posts',\n *      location: location // From react-router. Injected to your component by react-admin inside a List\n *      filterDefaultValues: {\n *          published: true\n *      },\n *      sort: {\n *          field: 'published_at',\n *          order: 'DESC'\n *      },\n *      perPage: 25\n * });\n *\n * const {\n *      page,\n *      perPage,\n *      sort,\n *      order,\n *      filter,\n *      filterValues,\n *      displayedFilters,\n *      requestSignature\n * } = listParams;\n *\n * const {\n *      setFilters,\n *      hideFilter,\n *      showFilter,\n *      setPage,\n *      setPerPage,\n *      setSort,\n * } = listParamsActions;\n */\nvar useListParams = function (_a) {\n    var resource = _a.resource, location = _a.location, filterDefaultValues = _a.filterDefaultValues, _b = _a.sort, sort = _b === void 0 ? defaultSort : _b, _c = _a.perPage, perPage = _c === void 0 ? 10 : _c, _d = _a.debounce, debounce = _d === void 0 ? 500 : _d;\n    var _e = useState({}), displayedFilters = _e[0], setDisplayedFilters = _e[1];\n    var dispatch = useDispatch();\n    var history = useHistory();\n    var params = useSelector(function (reduxState) {\n        return reduxState.admin.resources[resource]\n            ? reduxState.admin.resources[resource].list\n            : defaultParams;\n    }, shallowEqual).params;\n    var requestSignature = [\n        location.search,\n        resource,\n        params,\n        filterDefaultValues,\n        JSON.stringify(sort),\n        perPage,\n    ];\n    var query = useMemo(function () {\n        return getQuery({\n            location: location,\n            params: params,\n            filterDefaultValues: filterDefaultValues,\n            sort: sort,\n            perPage: perPage,\n        });\n    }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n    );\n    var changeParams = useCallback(function (action) {\n        var newParams = queryReducer(query, action);\n        history.push({\n            search: \"?\" + stringify(__assign({}, newParams, { filter: JSON.stringify(newParams.filter) })),\n        });\n        dispatch(changeListParams(resource, newParams));\n    }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n    var setSort = useCallback(function (newSort) {\n        return changeParams({ type: SET_SORT, payload: { sort: newSort } });\n    }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n    );\n    var setPage = useCallback(function (newPage) { return changeParams({ type: SET_PAGE, payload: newPage }); }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n    );\n    var setPerPage = useCallback(function (newPerPage) {\n        return changeParams({ type: SET_PER_PAGE, payload: newPerPage });\n    }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n    );\n    var filterValues = query.filter || emptyObject;\n    var debouncedSetFilters = lodashDebounce(function (newFilters) {\n        return changeParams({\n            type: SET_FILTER,\n            payload: removeEmpty(newFilters),\n        });\n    }, debounce);\n    var setFilters = useCallback(function (filters) { return debouncedSetFilters(filters); }, requestSignature // eslint-disable-line react-hooks/exhaustive-deps\n    );\n    var hideFilter = useCallback(function (filterName) {\n        setDisplayedFilters(function (previousFilters) {\n            var _a;\n            return (__assign({}, previousFilters, (_a = {}, _a[filterName] = false, _a)));\n        });\n        var newFilters = removeKey(filterValues, filterName);\n        setFilters(newFilters);\n    }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n    var showFilter = useCallback(function (filterName, defaultValue) {\n        var _a;\n        setDisplayedFilters(function (previousFilters) {\n            var _a;\n            return (__assign({}, previousFilters, (_a = {}, _a[filterName] = true, _a)));\n        });\n        if (typeof defaultValue !== 'undefined') {\n            setFilters(__assign({}, filterValues, (_a = {}, _a[filterName] = defaultValue, _a)));\n        }\n    }, requestSignature); // eslint-disable-line react-hooks/exhaustive-deps\n    return [\n        __assign({ displayedFilters: displayedFilters,\n            filterValues: filterValues,\n            requestSignature: requestSignature }, query),\n        {\n            changeParams: changeParams,\n            setPage: setPage,\n            setPerPage: setPerPage,\n            setSort: setSort,\n            setFilters: setFilters,\n            hideFilter: hideFilter,\n            showFilter: showFilter,\n        },\n    ];\n};\nexport var validQueryParams = ['page', 'perPage', 'sort', 'order', 'filter'];\nexport var parseQueryFromLocation = function (_a) {\n    var search = _a.search;\n    var query = pickBy(parse(search), function (v, k) { return validQueryParams.indexOf(k) !== -1; });\n    if (query.filter && typeof query.filter === 'string') {\n        try {\n            query.filter = JSON.parse(query.filter);\n        }\n        catch (err) {\n            delete query.filter;\n        }\n    }\n    return query;\n};\n/**\n * Check if user has already set custom sort, page, or filters for this list\n *\n * User params come from the Redux store as the params props. By default,\n * this object is:\n *\n * { filter: {}, order: null, page: 1, perPage: null, sort: null }\n *\n * To check if the user has custom params, we must compare the params\n * to these initial values.\n *\n * @param {object} params\n */\nexport var hasCustomParams = function (params) {\n    return (params &&\n        params.filter &&\n        (Object.keys(params.filter).length > 0 ||\n            params.order != null ||\n            params.page !== 1 ||\n            params.perPage != null ||\n            params.sort != null));\n};\n/**\n * Merge list params from 3 different sources:\n *   - the query string\n *   - the params stored in the state (from previous navigation)\n *   - the props passed to the List component (including the filter defaultValues)\n */\nexport var getQuery = function (_a) {\n    var location = _a.location, params = _a.params, filterDefaultValues = _a.filterDefaultValues, sort = _a.sort, perPage = _a.perPage;\n    var queryFromLocation = parseQueryFromLocation(location);\n    var query = Object.keys(queryFromLocation).length > 0\n        ? queryFromLocation\n        : hasCustomParams(params)\n            ? __assign({}, params) : { filter: filterDefaultValues || {} };\n    if (!query.sort) {\n        query.sort = sort.field;\n        query.order = sort.order;\n    }\n    if (!query.perPage) {\n        query.perPage = perPage;\n    }\n    if (!query.page) {\n        query.page = 1;\n    }\n    return __assign({}, query, { page: getNumberOrDefault(query.page, 1), perPage: getNumberOrDefault(query.perPage, 10) });\n};\nexport var getNumberOrDefault = function (possibleNumber, defaultValue) {\n    return (typeof possibleNumber === 'string'\n        ? parseInt(possibleNumber, 10)\n        : possibleNumber) || defaultValue;\n};\nexport default useListParams;\n"]},"metadata":{},"sourceType":"module"}