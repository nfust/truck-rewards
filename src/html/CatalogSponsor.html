<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">

   
    <link rel="stylesheet" href="catalog.css">

    <title>Catalog</title>
  </head>
  <body>
    <nav>
      <a href="index.php">Home</a>
      <a href="Catalog.php">Catalog</a>
      <a href="DriverOrders.html">Orders</a>
      <a href="SponsorInfo.html">Sponsor Information</a>
      <a href="earnPoints.html">Earn Points</a>
      <a href="DriverProfile.html" class="active">Account</a>
      <div class="logout">
        <form align="right" class="form" method="post" action="http://3.83.252.232:3001/logout">
          <button name="logout" type="submit">Log Out</button>
        </form>
      </div>

      <div class="cart">
        <button id="cart-button"type="button" name="cart" onclick="openForm()"><img id="cart-img" src="images/cart.png" alt="cart icon"></button>
        <form id="cart-form" align="right" class="" action="" method="post">
          <button id="close-button" type="button" name="close-button" onclick="closeForm()">X</button>
          <h3>Shopping Cart</h3><hr>
          <table id="items-table" style="overflow-y:scroll;height:145px;display:block;">
          </table>
          <a id="checkout-button" href="Checkout.html">Checkout</a>
          <a id="clear-button" href="http://3.83.252.232:3001/clearCart">Clear Cart</a>
          </form>
        </form>
      </div>
    </nav>	

<div class="container">
<p> Select sponsor's catalog </p>
<table id="sponsortable"></table>
</div>

    <script type="text/javascript">
      function openForm() {
        document.getElementById("cart-form").style.display = "block";
        document.getElementById("cart-button").style.background = "#007BC4";
      }
      function closeForm() {
        document.getElementById("cart-form").style.display = "none";
        document.getElementById("cart-button").style.background = "#444";
      }

    </script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="getCookie.js"></script>
<script type="text/javascript"charset="utf-8">
getURL = "http://3.83.252.232:3001/points/" + getCookie("username", document);
        $.ajax({
                type: "GET",
                url: getURL,
                success: function (data) {
		let resultString = "";
                        for(let i=0; i<data.length; i++){
				let info  = data[i];
				resultString = resultString + "<tr><td><a href=\"http://3.83.252.232/Catalog.php?sponsor=" + info["sponsor"] + "&driver="+info["username"]+"\" > " + info["sponsor"]+"</a></td></tr>";
		}
		console.log(resultString);
		document.getElementById("sponsortable").innerHTML = resultString;
                }
            });  

getURL = "http://3.83.252.232:3001/getCart/" + getCookie("username", document);
        $.ajax({
                type: "GET",
                url: getURL,
                success: function (data) {
                let resultString = "<tr><th>Item</th><th>Price</th></tr>";
                        for(let i=0; i<data.length; i++){
                                let info  = data[i];
                                resultString = resultString + "<tr><td>" + info["item_name"] + "</td><td>" + info["points"] + "</td></tr>";
                }
                console.log(resultString);
                document.getElementById("items-table").innerHTML = resultString;
                }
            });
</script>

</body>

</html>
